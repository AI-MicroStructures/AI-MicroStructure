<meta charset="utf-8"> <script src="http://yui.yahooapis.com/3.6.0/build/yui/yui-min.js"></script> <script src="http://code.jquery.com/jquery-latest.js"></script>  <link href="http://127.0.0.1:5984/app/_design/base/basex.css" media="screen" rel="stylesheet" type="text/css">  <link href="http://127.0.0.1:5984/app/_design/base/scope.css" media="screen" rel="stylesheet" type="text/css"> <style> body{margin:10px; } .todo-view { border-bottom: 1px dotted #CFCFCF; overflow: hidden; } #todo-stats {  margin: 0em auto;  text-align: left; } #todo-list { top:10px;  min-width:400px;  list-style: none;  padding: 0;  overflow: scoll; } #todo-stats, .todo-clear { color: #777; } .todo-clear { float: right; } .todo-done .todo-content {  color: #666;  text-decoration: line-through; } .todo-edit, .editing .todo-view { display: none; } .editing .todo-edit { display: block; } .todo-input {  display: block;  font-family: Helvetica, sans-serif;  font-size: 15px;  line-height: normal;  margin: 5px auto 0;  padding: 6px;  width: 115px; } .todo-item {  border-bottom: 1px dotted #cfcfcf;  font-size: 15px;  padding: 6px;  position: relative; } .todo-label {  color: #444;  font-size: 15px;  font-weight: bold;  text-align: center; } .todo-remaining {  color: #333;  font-weight: bold; } .todo-remove {  position: absolute;  right: 0;  top: 12px; } .todo-remove-icon {  /*  Delete icon courtesy of The Noun Project:  http://thenounproject.com/noun/delete/  background: url(../assets/app/remove.png) no-repeat;  */  display: block;  height: 16px;  opacity: 0.6;  visibility: hidden;  width: 23px; } .todo-remove:hover .todo-remove-icon { opacity: 1.0; } .todo-hover .todo-remove-icon, .todo-remove:focus .todo-remove-icon { visibility: visible; } .editing .todo-remove-icon { visibility: hidden; } .goin{ float:right; display:inline; } #demo { } /*  // border-left: 1px solid black;  // border-right: 1px solid black; // font-weight:bold; */ .counter{ text-align:center; font-size:1em; display:inline; color:orange; } #demo ul li {  border-bottom: 1px dotted #CFCFCF;  overflow: hidden;  background-color: #fff;  cursor: move;  color:blue;  width:300px:  margin: 1em;  list-style-type: none;  z-index: 1;  zoom: 1;  text-align:left; } #play {  position: relative;  zoom: 1; } #drop {  border: 1px solid black;  background-color: #eee;  height: 5px;  color:#fff;  width: 200px;  position: absolute;  bottom: 5px;  right: 5px;  zoom: 1; } #box {  display: block;  float: left;  font-style:normal;  text-align:center;  line-height:40px;  border: 1px solid #000;  margin: 6px 0;  color:#99CCCC;  font-size:90%;  -moz-box-shadow:4px 4px 7px rgba(0,0,0, 0.4);  -webkit-box-shadow:4px 4px 7px rgba(0,0,0, 0.4);  box-shadow:4px 4px 7px rgba(0,0,0, 0.4);  -moz-border-radius:3px;  -webkit-border-radius:3px;  cursor: move; } #drop strong {  font-weight: bold; } #drop.yui3-dd-drop-over {  background-color: #ccc; }  select {  display:inline;  width:200px;  margin: 15px;  }  #X{  display: inline;  font-family: Helvetica, sans-serif;  font-size: 14px;  line-height: normal;  margin: 5px auto 0;  padding: 5px;  width:240px;  }  button {  display: inline-block;  zoom: 1;  font-family: Helvetica, sans-serif;  line-height: normal;  margin: 5px auto 0;  padding: 6px;  text-align: left;  }  input {  display: inline-block;  zoom: 1;  font-family: Helvetica, sans-serif;  line-height: normal;  margin: 5px;  padding: 10px;  width: 140px;  }  a,table,tr,td {  margin:5px;  font-size:1.05em;  }  #demo{  padding:15px;  margin-left:1%;  margin-right:1%;  }  #am{  text-align: center;  margin-top:100px;  padding:4px;  } </style>  <div class="clearfix"></div>  <div id="results"></div>  <div id="container">  <div class="clearfix"></div>  <br>
  <script language="javascript" type="text/javascript">

 function xSend(message)
 {

      var sendMessage = document.getElementById("sendMessage");

      document.getElementById("sendMessage").value=message;

     // xSent(message);


 }

 function iterateAttributesAndFormHTMLLabels(o){
 var s = '';
 var xi = 0;


 $("#todo-list").append('<li onclick="xSend(this.value);"><span class="todo-content" tabindex="'+xi+'">[<b style="color:black;">'+o.spawn+'</b><span style="color:blue;" >'+o.neighbour+'</span></span>   <span style="float:right;"><img src="http://127.0.0.1:5984/app/_design/base/tiny-right.png"></span></li>');

//for (o.spawn){
///$('#last'+xi).append(".");
//}
 xi++;

 return s;
 }//end function

</script>
  <nav>  </nav>  <div id="main-container">  <strong>Message&nabla;</strong><strong style="margin:100px;display:inline;">Location&nabla;</strong><br>  <div id="main">  <div id="webSocketSupp"></div>  <div style="display:none;" id="noWebSocketSupp">  <div style="float: left;">  </div>  <div style="float: left; width: 60px; margin-left: 1px;">  <p>Uh-oh, the browser you're using doesn't have native support for WebSocket. That means you can't run this demo.</p>  <p>The following link lists the browsers that support WebSocket:</p>  </div>  </div>  <div id="echo">  <div id="echo-config" >  <input id="sendMessage" size="35" value="" class="yui3-aclist-input" aria-autocomplete="list" aria-expanded="false" aria-owns="yui_3_6_0_2_1347698521800_36" autocomplete="off">  <input id="wsUri" size="13" value="ws://127.0.0.1:3000" disabled="">  <input type="checkbox" id="secureCb" onclick="toggleTls();" style="display:none;" disabled="">  <span id="secureCbLabel" style="font-size: smaller; color: rgb(153, 153, 153); display:none;">Use secure WebSocket (TLS)</span><br>  <button id="connect" disabled="">Connect</button>  <button id="disconnect">Disconnect</button>  <button id="clearLogBut">Clear log</button>  <button id="send" class="box">Send</button>  <br>  <br> <code id="echo-log" style="float: left; margin-left: 20px; padding-left: 20px;width:58%; min-width: 900px; border-left: solid 1px #cccccc;"> <pre> <strong>Log:</strong> <div id="consoleLog"></div> </pre> </code>  </div>  <div class="clearfix"></div>

 <script>
 var secureCb;
 var secureCbLabel;
 var wsUri;
 var consoleLog;
 var connectBut;
 var disconnectBut;
 var sendMessage;
 var sendBut;
 var clearLogBut;
 function echoHandlePageLoad()
 {
 if (window.WebSocket)
 {
 document.getElementById("webSocketSupp").style.display = "block";
 }
 else
 {
 document.getElementById("noWebSocketSupp").style.display = "block";
 }
 secureCb = document.getElementById("secureCb");
 secureCb.checked = false;
 secureCb.onclick = toggleTls;
 secureCbLabel = document.getElementById("secureCbLabel")
 wsUri = document.getElementById("wsUri");
 toggleTls();
 connectBut = document.getElementById("connect");
 connectBut.onclick = doConnect;
 disconnectBut = document.getElementById("disconnect");
 disconnectBut.onclick = doDisconnect;
 sendMessage = document.getElementById("sendMessage");
 sendBut = document.getElementById("send");
 sendBut.onclick = doSend;
 consoleLog = document.getElementById("consoleLog");
 clearLogBut = document.getElementById("clearLogBut");
 clearLogBut.onclick = clearLog;
 setGuiConnected(false);
 document.getElementById("disconnect").onclick = doDisconnect;
 document.getElementById("send").onclick = doSend;
 }
 function toggleTls()
 {
 var wsPort = (window.location.port.toString() === "" ? "" : ":"+window.location.port)
 if (wsUri.value === "") {
 wsUri.value = "ws://" + window.location.hostname.replace("www", "echo") + wsPort;
 }
 if (secureCb.checked)
 {
 wsUri.value = wsUri.value.replace("ws:", "wss:");
 }
 else
 {
 wsUri.value = wsUri.value.replace ("wss:", "ws:");
 }
 }
 function doConnect()
 {
 if (window.MozWebSocket)
 {
 logToConsole('<span style="color: red;"><strong>Info:</strong> This browser supports WebSocket using the MozWebSocket constructor</span>');
 window.WebSocket = window.MozWebSocket;
 }
 else if (!window.WebSocket)
 {
 logToConsole('<span style="color: red;"><strong>Error:</strong> This browser does not have support for WebSocket</span>');
 return;
 }
 // prefer text messages
 var uri = wsUri.value;
 if (uri.indexOf("?") == -1) {
 uri += "?encoding=text";
 } else {
 uri += "&encoding=text";
 }
 websocket = new WebSocket(uri);
 websocket.onopen = function(evt) { onOpen(evt) };
 websocket.onclose = function(evt) { onClose(evt) };
 websocket.onmessage = function(evt) { onMessage(evt) };
 websocket.onerror = function(evt) { onError(evt) };
 }
 function doDisconnect()
 {
 websocket.close()
 }
 function doSend()
 {

 logToConsole("SENT: " + sendMessage.value);
 websocket.send(sendMessage.value);
 }
 function writeElem(message,i){
 var xmessage = '<li class="todo-view"><span class="todo-content" tabindex="'+i+'">'+message+'</span></div></li>';
 $("#todo-list").append(xmessage);
 }
 function logToConsole(message)
 {
 var pre = document.createElement("p");
 pre.style.wordWrap = "break-word";
 pre.innerHTML = getSecureTag()+message;
 consoleLog.appendChild(pre);
 while (consoleLog.childNodes.length > 50)
 {
 consoleLog.removeChild(consoleLog.firstChild);
 }
 consoleLog.scrollTop = consoleLog.scrollHeight;
 }
 function onOpen(evt)
 {
 logToConsole("CONNECTED");
 setGuiConnected(true);
 }
 function onClose(evt)
 {
 logToConsole("DISCONNECTED");
 setGuiConnected(false);
 }
 function onMessage(evt)
 {
 if(evt.data.match("{")){
 var elem = JSON.parse(evt.data.toString());
 var xlist = elem.responce[0];
 $("#todo-list").empty();

 for(a in xlist){
iterateAttributesAndFormHTMLLabels(xlist[a]);
 }}
 }
 function onError(evt)
 {
 logToConsole('<span style="color: red;">ERROR:</span> ' + evt.data);
 }
 function setGuiConnected(isConnected)
 {
 wsUri.disabled = isConnected;
 connectBut.disabled = isConnected;
 disconnectBut.disabled = !isConnected;
 sendMessage.disabled = !isConnected;
 sendBut.disabled = !isConnected;
 secureCb.disabled = isConnected;
 var labelColor = "black";
 if (isConnected)
 {
 labelColor = "#999999";
 }
 secureCbLabel.style.color = labelColor;
 }
 function clearLog()
 {
 while (consoleLog.childNodes.length > 0)
 {
 consoleLog.removeChild(consoleLog.lastChild);
 }
 $("#todo-list").empty();
 }
 function getSecureTag()
 {
 if (secureCb.checked)
 {
 return 'lock';
 }
 else
 {
 return '';
 }
 }
 window.addEventListener("load", echoHandlePageLoad, false);
 </script>
 <script>
 $('#webSocketSupp').fadeIn(250);
 setTimeout(function(){$('#webSocketSupp').fadeOut(250,function(){
 document.getElementById("connect").click();
 $('#webSocketSupp').remove();
 $('#connect').click(1);
 })},250);
 </script>

 </div>  </div> <ul id="todo-list"> </ul> </div></div></body></html>
